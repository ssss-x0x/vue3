# 第 4 章 データとイベントのディレクティブ

## データバインディングのディレクティブ

- HTML タグ内の属性に変数を利用したい場合に利用する。
- `v-` で始まる。
- ディレクティブの中に記述できるのは式だけであり、文は使用できない。

```
○ <a :href="url">URLはこちら</a>
× <a :href="const url = 'https://...'; return url;">URLはこちら</a>
```

- オブジェクトを直接 `v-bind` に渡すことで複数属性へのディレクティブを一度に記述できる(directive-bind-object)

## v-on イベント

- フォーカス・マウス操作・入力など JS で用意されているイベントを設定できる
  [参考: イベントの種類](https://javascript.pc-users.net/event_handler/list.html)

- v-on ディレクティブの修飾子（Modifiers）は以下のとおり

| 修飾子  | 内容                                                                                               |
| ------- | -------------------------------------------------------------------------------------------------- |
| stop    | バブリングフェーズで親要素に設定されたイベントハンドラの実行をキャンセルする                       |
| capture | イベントリスナをキャプチャモードに設定し、キャプチャフェーズでのみ該当のイベントハンドラを実行する |
| self    | 要素自体がイベント発生源だった場合のみイベントハンドラを実行する                                   |
| prevent | イベントの規定処理をキャンセルする。内部では JS 標準の `preventDefault()` メソッドを呼び出している |
| passive | 該当イベントのデフォルトの挙動が即時実行される                                                     |
| once    | イベントの実行を 1 回のみとする                                                                    |

### 補足: DOM イベントのフェーズ

1. キャプチャフェーズ: window で発生し、イベントの発生源まで要素を順番に辿っていくフェーズ
1. ターゲットフェーズ: イベント発生源を特定し、対象のタグに登録されたイベントハンドラが呼び出されるフェーズ
1. バブリングフェーズ: ターゲットフェーズでイベントの発生源を特定した後はキャプチャフェーズの逆を辿って親要素(window)まで遡るフェーズ

```
【例】
  <html>
    <body>
      <section>
        <div>
          <button @click="someFunction">クリック</button> // ここがクリックされた場合、イベントの発生源はbuttonタグとなる
        </div>
      </section>
    </body>
  </html>
```

## キーイベントの修飾子

- keydown, keypress, keyup の「キーイベント」に対して、押されたキーに対応する修飾子を追加で付与できる。

```
【例】
  // エンターキーが押下された時
  <input type="text" @keydown.enter="onEnterKeyEvent" />

  // [Q]キーが押下されたとき
  <input type="text" @keydown.q="onQKeyEvent" />
```

| 修飾子 | 対応キー                    |
| ------ | --------------------------- |
| enter  | [Enter]                     |
| tab    | [Tab]                       |
| delete | [Delete] または [Backspace] |
| esc    | [Esc]                       |
| space  | [Space]                     |
| up     | [↑]                         |
| down   | [↓]                         |
| left   | [←]                         |
| right  | [→]                         |

## click イベントの修飾子

- click イベント修飾子を設定することで、click イベントと組み合わせてマウスの特定のボタンがクリックされた時にのみイベントを実行させることができる

| 修飾子 | 対応操作   |
| ------ | ---------- |
| left   | 左クリック |
| right  | 右クリック |
| middle | 中クリック |

## システム修飾子

- 該当するキーが押下されている時のみ設定したイベントを実行させることができる

| 修飾子 | 対応キー                           |
| ------ | ---------------------------------- |
| ctrl   | [Ctrl]                             |
| alt    | [Alt]                              |
| shift  | [Shift]                            |
| meta   | MacOS は [⌘], Windows は [Windows] |

## exact 修飾子

- 対象のキーが単独で押された場合にのみ限定してイベントを実行されたい場合は `.exact` 修飾子を併用する
